# âš¡ğŸŒŒ AUREON POWER STATION - DIGITAL OCEAN APP PLATFORM
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# PRIMARY INTERFACE: Queen Power Station (Port 8080)
#   Shows everything as ENERGY - reserves, generation, consumption, flows
#
# PARALLEL PROCESSES via supervisord (startup order by priority):
#   1. ğŸ›¡ï¸ Queen Soul Shield (pri 1) - Protection first
#   2. ğŸŒŸ Deployment Coordinator (pri 5) - Health checks & status
#   3. ğŸ‘‘ Queen Eternal Machine (pri 10) - 7 Strategies: Mountain/Frog/Bloodless/Road/Breadcrumbs/24-7/Scalping
#      â”œâ”€ Mountain Pilgrimage: DCA down, compound up
#      â”œâ”€ Quantum Frog: Leap to deeper dips for quantity
#      â”œâ”€ Bloodless Descent: Never sell at loss
#      â”œâ”€ Yellow Brick Road: Leave trail of positions  
#      â”œâ”€ Breadcrumb Trail: Every crumb grows on recovery
#      â”œâ”€ 24/7 Machine: Constant scanning/leaping/compounding
#      â”œâ”€ Micro Scalping: Harvest bounces
#      â””â”€ ORCA KILL CYCLE DEFENSE: Protect 41 friends from whale attacks
#   4. ğŸ¦ˆ Orca Kill Cycle (pri 15) - Multi-exchange aggressive trader
#   5. ğŸ§  Autonomous Engine (pri 20) - 9 Intelligence loops  
#   6. ğŸ Queen Redistribution (pri 25) - Autonomous energy optimization
#   7. âš¡ Queen Power Station (port 8080) - PRIMARY energy monitoring interface
#   8. ğŸ‘‘ Command Center (port 8800, pri 50) - Internal operations dashboard
#
# All processes start together on boot via supervisord.conf
#
# Gary Leckey | January 2026 | ENERGY-FOCUSED INTERFACE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: aureon-trading
region: lon

services:
  # âš¡ MAIN SERVICE - Runs ALL parallel processes via supervisord
  - name: aureon-power-station
    dockerfile_path: Dockerfile
    source_dir: /
    github:
      branch: main
      deploy_on_push: true
      repo: RA-CONSULTING/aureon-trading
    
    # HTTP settings for health checks
    http_port: 8080
    instance_count: 1
    instance_size_slug: apps-d-8vcpu-32gb  # 32GB RAM, 8 vCPU - DigitalOcean recommended size
    
    # Autoscaling for memory spikes during parallel supervisord startup
    autoscaling:
      min_instance_count: 1
      max_instance_count: 2
      metrics:
        cpu:
          percent: 80
        memory:
          percent: 85
    
    # Health check - Queen Power Dashboard /health endpoint on port 8080
    # Extended initial delay to allow supervisor + 43 processes to start sequentially
    health_check:
      http_path: /health
      initial_delay_seconds: 600
      period_seconds: 60
      timeout_seconds: 30
      success_threshold: 1
      failure_threshold: 10
    
    # Environment variables
    envs:
      # Python settings
      - key: PYTHONUNBUFFERED
        scope: RUN_AND_BUILD_TIME
        value: "1"
      - key: PYTHONIOENCODING
        scope: RUN_AND_BUILD_TIME
        value: "utf-8"
      
      # Aureon settings
      - key: PORT
        scope: RUN_TIME
        value: "8080"
      - key: AUREON_SKIP_KRAKEN_SEED
        scope: RUN_TIME
        value: "1"
      - key: AUREON_STATE_DIR
        scope: RUN_TIME
        value: /app/state
      - key: KRAKEN_NONCE_PATH
        scope: RUN_TIME
        value: /app/state/kraken_nonce.json
      - key: KRAKEN_PRIVATE_LOCK_PATH
        scope: RUN_TIME
        value: /app/state/kraken_private.lock
      - key: AUREON_ENABLE_AUTONOMOUS_CONTROL
        scope: RUN_TIME
        value: "1"
      
      # ğŸ”¥ LIVE TRADING MODE
      - key: LIVE
        scope: RUN_TIME
        value: "1"
      - key: KRAKEN_DRY_RUN
        scope: RUN_TIME
        value: "false"
      - key: BINANCE_DRY_RUN
        scope: RUN_TIME
        value: "false"
      - key: ALPACA_DRY_RUN
        scope: RUN_TIME
        value: "false"
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # âš ï¸ API KEYS - SET THESE IN DIGITAL OCEAN DASHBOARD âš ï¸
      # Go to: App > Settings > App-Level Environment Variables
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      # ğŸ™ KRAKEN
      - key: KRAKEN_API_KEY
        scope: RUN_TIME
        type: SECRET
      - key: KRAKEN_API_SECRET
        scope: RUN_TIME
        type: SECRET
      
      # ğŸŸ¡ BINANCE
      - key: BINANCE_API_KEY
        scope: RUN_TIME
        type: SECRET
      - key: BINANCE_API_SECRET
        scope: RUN_TIME
        type: SECRET
      
      # ğŸ¦™ ALPACA
      - key: ALPACA_API_KEY
        scope: RUN_TIME
        type: SECRET
      - key: ALPACA_SECRET_KEY
        scope: RUN_TIME
        type: SECRET
      
      # ğŸ’¼ CAPITAL.COM (CFD Trading)
      - key: CAPITAL_API_KEY
        scope: RUN_TIME
        type: SECRET
      - key: CAPITAL_IDENTIFIER
        scope: RUN_TIME
        type: SECRET
      - key: CAPITAL_PASSWORD
        scope: RUN_TIME
        type: SECRET
      - key: CAPITAL_DEMO
        scope: RUN_TIME
        value: "false"
      
      # ğŸ§  Redis for ThoughtBus (optional - uses internal if available)
      - key: AUREON_REDIS_URL
        scope: RUN_TIME
        value: "${db.REDIS_URL}"

# ğŸ§  Redis Database for ThoughtBus Pub/Sub
databases:
  - name: db
    engine: REDIS
    production: true
    version: "7"
